---
# Main entry point for Firewall role

- name: Ensure firewalld is installed
  ansible.builtin.dnf:
    name: firewalld
    state: present
  become: true

- name: Ensure firewalld is running
  ansible.builtin.systemd:
    name: firewalld
    state: started
    enabled: true
  become: true

- name: Configure firewall for Cockpit
  ansible.builtin.import_tasks: cockpit.yml
  when: cockpit_firewall_enabled | default(true)
  tags: ['firewall-cockpit']

- name: Configure firewall for AdGuard Home
  ansible.builtin.import_tasks: adguard.yml
  when: adguard_firewall_enabled | default(true)
  tags: ['firewall-adguard']

- name: Configure firewall for FileBrowser
  ansible.builtin.import_tasks: filebrowser.yml
  when: filebrowser_firewall_enabled | default(true)
  tags: ['firewall-filebrowser']

- name: Configure firewall for Jellyfin
  ansible.builtin.import_tasks: jellyfin.yml
  when: jellyfin_firewall_enabled | default(true)
  tags: ['firewall-jellyfin']

- name: Configure firewall for Cloud Torrent
  ansible.builtin.import_tasks: cloud_torrent.yml
  when: cloud_torrent_firewall_enabled | default(true)
  tags: ['firewall-cloud-torrent']

- name: Configure firewall for Immich
  ansible.builtin.import_tasks: immich.yml
  when: immich_firewall_enabled | default(false)
  tags: ['firewall-immich']

- name: Configure firewall for Kavita
  ansible.builtin.import_tasks: kavita.yml
  when: kavita_firewall_enabled | default(false)
  tags: ['firewall-kavita']

- name: Configure firewall for NGINX
  ansible.builtin.import_tasks: nginx.yml
  when: nginx_firewall_enabled | default(true)
  tags: ['firewall-nginx']
